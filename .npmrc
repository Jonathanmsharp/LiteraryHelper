# PNPM Configuration for Vercel Deployment

# Improve compatibility with Vercel by using hoisted node modules
node-linker=hoisted

# Enable shameful hoisting to resolve dependency issues in monorepos
shamefully-hoist=true

# Optimize build performance with reasonable concurrency
workspace-concurrency=4

# Ensure packages can find each other in the workspace
link-workspace-packages=true

# Use strict peer dependencies to avoid conflicts
strict-peer-dependencies=false

# Ensure public hoist patterns for Next.js dependencies
public-hoist-pattern[]=*next*
public-hoist-pattern[]=*react*
public-hoist-pattern[]=*react-dom*
public-hoist-pattern[]=@clerk/*
public-hoist-pattern[]=*eslint*
public-hoist-pattern[]=*typescript*

# Vercel specific settings
save-workspace-protocol=false
save-prefix=''

# Prefer offline installation when possible for faster builds
prefer-offline=true

# Disable update notifications during CI/CD
update-notifier=false

# --------------------------------------------------------------------
# Deployment compatibility tweaks
# --------------------------------------------------------------------
# Disable pnpm's frozen lockfile behaviour on Vercel.  The build
# containers often have a slightly different package graph (for
# example when the lockfile is regenerated during CI).  Turning this
# off prevents the install from error-ing out with:
#   ERR_PNPM_OUTDATED_LOCKFILE
# Equivalent to using the CLI flag `--no-frozen-lockfile`.
frozen-lockfile=false
